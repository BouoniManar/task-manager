<div class="task-management-container">
  <h2 class="text-center">Task Management</h2>

  <div class="task-filters">
    <p-button label="Add New Task" icon="pi pi-plus" (click)="openTaskDialog()" class="p-button-sm p-button-rounded"></p-button>
  </div>

  <div class="task-table-container">
    <p-table [value]="tasks" dataKey="id" [paginator]="true" [rows]="10" [filterDelay]="500" [sortField]="'name'" [sortOrder]="1">
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="name">Task Name <p-sortIcon field="name"></p-sortIcon></th>
          <th pSortableColumn="creationDate">Creation Date <p-sortIcon field="creationDate"></p-sortIcon></th>
          <th pSortableColumn="status">Status <p-sortIcon field="status"></p-sortIcon></th>
          <th>Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-task>
        <tr [class.completed]="task.completed">
          <td>{{ task.name }}</td>
          <td>{{ task.creationDate | date }}</td>
          <td>{{ task.completed ? 'Completed' : 'Pending' }}</td>
          <td>
            <button
              pButton
              icon="pi pi-pencil"
              class="p-button-rounded p-button-success p-button-sm"
              (click)="openTaskDialog(task)"
              tooltip="Edit Task"
              tooltipPosition="top">
            </button>
            <button
              pButton
              icon="pi pi-trash"
              class="p-button-rounded p-button-danger p-button-sm"
              (click)="confirmDelete(task)"
              tooltip="Delete Task"
              tooltipPosition="top">
            </button>
            <p-button
            [icon]="task.completed ? 'pi pi-times' : 'pi pi-check'"
            class="p-button-rounded p-button-sm p-button-info"
            (click)="toggleCompletion(task)"
            tooltip="Toggle Completion"
            tooltipPosition="top">
          </p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>

  </div>

  <p-dialog header="Create/Edit Task" [(visible)]="taskDialog" [style]="{width: '500px'}">
    <div class="p-fluid">
      <div class="p-field">
        <label for="taskName">Task Name</label>
        <input type="text" pInputText id="taskName" [(ngModel)]="selectedTask.name" placeholder="Enter task name" />
      </div>

      <div class="p-field">
        <label for="status">Status</label>
        <input type="text"pInputText id="status"[(ngModel)]="selectedTask.status"[disabled]="!selectedTask.id"placeholder="Enter status" />
      </div>

      <div class="p-field">
        <label for="createdDate">Creation Date</label>
        <input type="date" pInputText id="createdDate" [(ngModel)]="selectedTask.creationDate" placeholder="Enter creation date" />
      </div>
      <p-footer>
        <div class="button-container mt-4">
          <button pButton type="button" label="Save" icon="pi pi-check" (click)="saveTask()"></button>
          <button pButton type="button" label="Cancel" icon="pi pi-times" (click)="closeDialog()" class="p-button-outlined"></button>
        </div>
      </p-footer>
    </div>
  </p-dialog>

  <p-confirmDialog header="Confirm Deletion" icon="pi pi-exclamation-triangle"></p-confirmDialog>

  <p-toast></p-toast>
</div>
